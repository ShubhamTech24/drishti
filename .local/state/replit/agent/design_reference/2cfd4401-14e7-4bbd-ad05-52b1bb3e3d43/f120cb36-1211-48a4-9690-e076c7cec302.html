<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drishti - Crowd Management Command Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
    tailwind.config = {
        theme: {
            extend: {
                borderRadius: {
                    lg: "var(--radius)",
                    md: "calc(var(--radius) - 2px)",
                    sm: "calc(var(--radius) - 4px)",
                },
                colors: {
                    background: "var(--background)",
                    foreground: "var(--foreground)",
                    card: {
                        DEFAULT: "var(--card)",
                        foreground: "var(--card-foreground)",
                    },
                    primary: {
                        DEFAULT: "var(--primary)",
                        foreground: "var(--primary-foreground)",
                    },
                    secondary: {
                        DEFAULT: "var(--secondary)",
                        foreground: "var(--secondary-foreground)",
                    },
                    accent: {
                        DEFAULT: "var(--accent)",
                        foreground: "var(--accent-foreground)",
                    },
                    muted: {
                        DEFAULT: "var(--muted)",
                        foreground: "var(--muted-foreground)",
                    },
                    destructive: {
                        DEFAULT: "var(--destructive)",
                        foreground: "var(--destructive-foreground)",
                    },
                    success: {
                        DEFAULT: "var(--success)",
                        foreground: "var(--success-foreground)",
                    },
                    border: "var(--border)",
                    input: "var(--input)",
                    ring: "var(--ring)",
                }
            }
        }
    };
    </script>
    <style>
        :root {
            --background: hsl(60 15% 96%);
            --foreground: hsl(195 15% 20%);
            --card: hsl(60 10% 98%);
            --card-foreground: hsl(195 15% 20%);
            --primary: hsl(14 100% 60%);
            --primary-foreground: hsl(0 0% 100%);
            --secondary: hsl(25 50% 25%);
            --secondary-foreground: hsl(60 15% 96%);
            --accent: hsl(51 100% 50%);
            --accent-foreground: hsl(195 15% 20%);
            --muted: hsl(60 10% 92%);
            --muted-foreground: hsl(195 10% 40%);
            --destructive: hsl(348 83% 47%);
            --destructive-foreground: hsl(0 0% 100%);
            --success: hsl(120 60% 30%);
            --success-foreground: hsl(0 0% 100%);
            --border: hsl(60 10% 85%);
            --input: hsl(60 10% 85%);
            --ring: hsl(14 100% 60%);
            --radius: 0.5rem;
            --font-sans: 'Noto Sans', system-ui, sans-serif;
        }

        body {
            font-family: var(--font-sans);
            background: linear-gradient(135deg, var(--background) 0%, hsl(60 20% 94%) 100%);
        }

        .command-center-bg {
            background: radial-gradient(circle at 50% 50%, hsl(195 15% 20% / 0.05) 0%, transparent 70%);
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .severity-critical { background-color: var(--destructive); }
        .severity-high { background-color: hsl(20 100% 50%); }
        .severity-medium { background-color: var(--accent); }
        .severity-low { background-color: var(--success); }

        .heatmap-legend {
            background: linear-gradient(to right, 
                var(--success) 0%, 
                var(--accent) 35%, 
                hsl(20 100% 50%) 70%, 
                var(--destructive) 100%);
        }

        .grid-dashboard {
            display: grid;
            grid-template-columns: 1fr 350px;
            grid-template-rows: auto 1fr;
            gap: 1rem;
            height: calc(100vh - 4rem);
        }

        @media (max-width: 1024px) {
            .grid-dashboard {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto 1fr;
            }
        }
    </style>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/heroicons@2.0.18/24/outline/index.js" type="module"></script>
</head>
<body class="bg-background text-foreground min-h-screen">
    <!-- @COMPONENT: Header [navigation and system status] -->
    <header class="bg-card border-b border-border shadow-sm">
        <div class="max-w-full px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-primary-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                            </svg>
                        </div>
                        <div>
                            <h1 class="text-xl font-bold text-foreground">Drishti</h1>
                            <p class="text-xs text-muted-foreground">Mahakumbh 2028 Command Center</p>
                        </div>
                    </div>
                    <div class="hidden md:flex items-center space-x-1 text-sm">
                        <span class="text-muted-foreground">Zone:</span>
                        <span class="font-medium">Ramghat-A</span>
                        <span class="text-muted-foreground">|</span>
                        <span class="text-muted-foreground">Active Cameras:</span>
                        <span class="font-medium text-success">47/52</span>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <div class="status-indicator severity-low"></div>
                        <span class="text-sm text-muted-foreground">System Status: </span>
                        <span class="text-sm font-medium text-success">Operational</span>
                    </div>
                    
                    <div class="flex items-center space-x-2 text-sm">
                        <svg class="w-4 h-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <span class="font-mono" data-bind="currentTime">14:32:45 IST</span>
                    </div>
                    
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-secondary rounded-full flex items-center justify-center">
                            <span class="text-xs font-semibold text-secondary-foreground">OP</span>
                        </div>
                        <span class="text-sm font-medium">Operator</span>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- @END_COMPONENT: Header -->

    <main class="command-center-bg">
        <div class="max-w-full px-6 py-4">
            <div class="grid-dashboard">
                <!-- @COMPONENT: TopToolbar [emergency controls and system status] -->
                <div class="col-span-full bg-card rounded-lg border border-border p-4 shadow-sm">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <button data-event="click:triggerEmergencyAlert" class="bg-destructive hover:bg-destructive/90 text-destructive-foreground px-6 py-3 rounded-lg font-semibold flex items-center space-x-2 shadow-lg">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 18.5c-.77.833.192 2.5 1.732 2.5z"></path>
                                </svg>
                                <span>EMERGENCY ALERT</span>
                            </button>
                            
                            <div class="flex items-center space-x-3">
                                <span class="text-sm font-medium text-muted-foreground">Global Status:</span>
                                <div class="flex items-center space-x-2">
                                    <div class="status-indicator severity-medium"></div>
                                    <span class="text-sm font-semibold text-accent">MODERATE ALERT</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex items-center space-x-4">
                            <div class="text-right">
                                <p class="text-2xl font-bold text-foreground" data-bind="totalPilgrims">2,847,392</p>
                                <p class="text-xs text-muted-foreground">Total Pilgrims</p>
                            </div>
                            
                            <div class="text-right">
                                <p class="text-2xl font-bold text-primary" data-bind="activeIncidents">23</p>
                                <p class="text-xs text-muted-foreground">Active Incidents</p>
                            </div>
                            
                            <div class="text-right">
                                <p class="text-2xl font-bold text-success" data-bind="resolvedToday">187</p>
                                <p class="text-xs text-muted-foreground">Resolved Today</p>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- @END_COMPONENT: TopToolbar -->

                <!-- @COMPONENT: MainMap [interactive crowd density map] -->
                <div class="bg-card rounded-lg border border-border overflow-hidden shadow-lg">
                    <div class="p-4 border-b border-border bg-muted/30">
                        <div class="flex items-center justify-between">
                            <h2 class="text-lg font-semibold text-foreground">Live Crowd Density Map</h2>
                            <div class="flex items-center space-x-2">
                                <div class="heatmap-legend w-24 h-3 rounded-full"></div>
                                <span class="text-xs text-muted-foreground">Low → Critical</span>
                            </div>
                        </div>
                    </div>
                    <div class="relative">
                        <div id="map" class="h-96 lg:h-[500px]" data-implementation="Implement Leaflet map with real-time heatmap overlay">
                            <!-- Leaflet map will be initialized here -->
                        </div>
                        <div class="absolute top-4 right-4 bg-card/95 backdrop-blur-sm rounded-lg p-3 border border-border">
                            <div class="text-xs text-muted-foreground mb-1">Zone Status</div>
                            <div class="space-y-1">
                                <div class="flex items-center justify-between space-x-3">
                                    <span class="text-xs">Ramghat-A</span>
                                    <div class="flex items-center space-x-1">
                                        <div class="w-2 h-2 bg-destructive rounded-full"></div>
                                        <span class="text-xs font-semibold">Critical</span>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between space-x-3">
                                    <span class="text-xs">Triveni-B</span>
                                    <div class="flex items-center space-x-1">
                                        <div class="w-2 h-2 bg-accent rounded-full"></div>
                                        <span class="text-xs">Moderate</span>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between space-x-3">
                                    <span class="text-xs">Temple-C</span>
                                    <div class="flex items-center space-x-1">
                                        <div class="w-2 h-2 bg-success rounded-full"></div>
                                        <span class="text-xs">Normal</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- @END_COMPONENT: MainMap -->

                <!-- @COMPONENT: IncidentPanel [real-time incident feed and management] -->
                <div class="bg-card rounded-lg border border-border overflow-hidden shadow-lg">
                    <div class="p-4 border-b border-border bg-muted/30">
                        <div class="flex items-center justify-between">
                            <h2 class="text-lg font-semibold text-foreground">Active Incidents</h2>
                            <div class="flex items-center space-x-2">
                                <span class="text-xs text-muted-foreground">Auto-refresh</span>
                                <div class="status-indicator severity-low"></div>
                            </div>
                        </div>
                    </div>
                    <div class="h-96 lg:h-[500px] overflow-y-auto">
                        <!-- @MAP: incidents.map(incident => ( -->
                        <div class="p-4 border-b border-border hover:bg-muted/50 transition-colors" data-mock="true">
                            <div class="flex items-start space-x-3">
                                <div class="w-3 h-3 bg-destructive rounded-full mt-1 flex-shrink-0"></div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-center justify-between mb-1">
                                        <h3 class="text-sm font-semibold text-foreground">Crowd Surge Detected</h3>
                                        <span class="text-xs text-muted-foreground">14:28</span>
                                    </div>
                                    <p class="text-xs text-muted-foreground mb-2">Ramghat-A, Sector 3 - Est. 850+ people</p>
                                    <p class="text-sm text-foreground mb-3">AI Analysis: Sudden directional movement toward main exit, blocking detected</p>
                                    <div class="flex items-center space-x-2 mb-3">
                                        <!-- High-density crowd scene at a religious gathering -->
                                        <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&h=60" alt="Crowd density snapshot" class="w-16 h-10 rounded object-cover" data-mock-image="true" />
                                        <div class="text-xs">
                                            <div class="text-muted-foreground">Confidence: <span class="font-semibold">87%</span></div>
                                            <div class="text-muted-foreground">Camera: <span class="font-semibold">RG-A-03</span></div>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <button data-event="click:assignVolunteer" class="bg-primary hover:bg-primary/90 text-primary-foreground px-3 py-1 rounded text-xs font-medium">
                                            Assign
                                        </button>
                                        <button data-event="click:acknowledgeIncident" class="bg-secondary hover:bg-secondary/90 text-secondary-foreground px-3 py-1 rounded text-xs font-medium">
                                            Acknowledge
                                        </button>
                                        <button data-event="click:sendAlert" class="bg-accent hover:bg-accent/90 text-accent-foreground px-3 py-1 rounded text-xs font-medium">
                                            Send Alert
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="p-4 border-b border-border hover:bg-muted/50 transition-colors" data-mock="true">
                            <div class="flex items-start space-x-3">
                                <div class="w-3 h-3 bg-accent rounded-full mt-1 flex-shrink-0"></div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-center justify-between mb-1">
                                        <h3 class="text-sm font-semibold text-foreground">Medical Emergency</h3>
                                        <span class="text-xs text-muted-foreground">14:25</span>
                                    </div>
                                    <p class="text-xs text-muted-foreground mb-2">Triveni Ghat, Near Stairs - Reported by pilgrim</p>
                                    <p class="text-sm text-foreground mb-3">Elderly person collapsed, needs immediate assistance</p>
                                    <div class="flex items-center space-x-2 mb-3">
                                        <div class="text-xs">
                                            <div class="text-muted-foreground">Reporter: <span class="font-semibold">Anonymous</span></div>
                                            <div class="text-muted-foreground">Priority: <span class="font-semibold text-accent">Medium</span></div>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <span class="bg-primary/10 text-primary px-2 py-1 rounded text-xs font-medium">
                                            Assigned to: Vol-247
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="p-4 border-b border-border hover:bg-muted/50 transition-colors" data-mock="true">
                            <div class="flex items-start space-x-3">
                                <div class="w-3 h-3 bg-success rounded-full mt-1 flex-shrink-0"></div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-center justify-between mb-1">
                                        <h3 class="text-sm font-semibold text-foreground">Lost Child Report</h3>
                                        <span class="text-xs text-muted-foreground">14:22</span>
                                    </div>
                                    <p class="text-xs text-muted-foreground mb-2">Har ki Pauri, Main Area - Voice report</p>
                                    <p class="text-sm text-foreground mb-3">"मेरा बच्चा गुम हो गया है, 8 साल का लड़का" (My child is lost, 8-year-old boy)</p>
                                    <div class="flex items-center space-x-2 mb-3">
                                        <div class="text-xs">
                                            <div class="text-muted-foreground">Language: <span class="font-semibold">Hindi</span></div>
                                            <div class="text-muted-foreground">Transcript confidence: <span class="font-semibold">94%</span></div>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <button data-event="click:searchLostPersonDB" class="bg-accent hover:bg-accent/90 text-accent-foreground px-3 py-1 rounded text-xs font-medium">
                                            Search Database
                                        </button>
                                        <span class="bg-success/10 text-success px-2 py-1 rounded text-xs font-medium">
                                            In Progress
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="p-4 border-b border-border hover:bg-muted/50 transition-colors" data-mock="true">
                            <div class="flex items-start space-x-3">
                                <div class="w-3 h-3 bg-secondary rounded-full mt-1 flex-shrink-0"></div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-center justify-between mb-1">
                                        <h3 class="text-sm font-semibold text-foreground">Infrastructure Issue</h3>
                                        <span class="text-xs text-muted-foreground">14:18</span>
                                    </div>
                                    <p class="text-xs text-muted-foreground mb-2">Station Road Bridge - Maintenance alert</p>
                                    <p class="text-sm text-foreground mb-3">Temporary barricade needed, pathway narrowing detected</p>
                                    <div class="flex items-center space-x-2">
                                        <span class="bg-muted text-muted-foreground px-2 py-1 rounded text-xs font-medium">
                                            Resolved - 14:31
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- @END_MAP )) -->
                    </div>
                </div>
                <!-- @END_COMPONENT: IncidentPanel -->

                <!-- @COMPONENT: CameraFeeds [live surveillance monitoring] -->
                <div class="col-span-full lg:col-span-1 bg-card rounded-lg border border-border overflow-hidden shadow-lg">
                    <div class="p-4 border-b border-border bg-muted/30">
                        <h2 class="text-lg font-semibold text-foreground">Live Camera Feeds</h2>
                    </div>
                    <div class="p-4 space-y-4 h-96 lg:h-[400px] overflow-y-auto">
                        <!-- @MAP: cameraFeeds.map(feed => ( -->
                        <div class="border border-border rounded-lg overflow-hidden" data-mock="true">
                            <div class="relative">
                                <!-- Real-time crowd monitoring at a religious gathering -->
                                <img src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=200" alt="Camera feed from Ramghat-A" class="w-full h-32 object-cover" data-mock-image="true" />
                                <div class="absolute top-2 left-2 bg-destructive text-destructive-foreground px-2 py-1 rounded text-xs font-bold">
                                    LIVE
                                </div>
                                <div class="absolute top-2 right-2 bg-card/90 backdrop-blur-sm text-foreground px-2 py-1 rounded text-xs">
                                    RG-A-03
                                </div>
                            </div>
                            <div class="p-3">
                                <div class="flex items-center justify-between mb-2">
                                    <h3 class="text-sm font-semibold text-foreground">Ramghat-A Sector 3</h3>
                                    <div class="flex items-center space-x-1">
                                        <div class="w-2 h-2 bg-destructive rounded-full"></div>
                                        <span class="text-xs font-medium text-destructive">Critical</span>
                                    </div>
                                </div>
                                <div class="text-xs text-muted-foreground space-y-1">
                                    <div>Est. People: <span class="font-semibold">850+</span></div>
                                    <div>Density: <span class="font-semibold text-destructive">Very High</span></div>
                                    <div>Behavior: <span class="font-semibold">Panic Movement</span></div>
                                </div>
                            </div>
                        </div>

                        <div class="border border-border rounded-lg overflow-hidden" data-mock="true">
                            <div class="relative">
                                <!-- Aerial view of crowd at temple complex -->
                                <img src="https://pixabay.com/get/ga65a52625a490b731bb00b3cac204d7f57b948c8c1edc56a5091f55af2ad22574e119c34e74c0c412055a259de9ab7b1da2d407fb1476f89fb96c65a3f1fff59_1280.jpg" alt="Camera feed from Temple-C" class="w-full h-32 object-cover" data-mock-image="true" />
                                <div class="absolute top-2 left-2 bg-success text-success-foreground px-2 py-1 rounded text-xs font-bold">
                                    LIVE
                                </div>
                                <div class="absolute top-2 right-2 bg-card/90 backdrop-blur-sm text-foreground px-2 py-1 rounded text-xs">
                                    TC-C-07
                                </div>
                            </div>
                            <div class="p-3">
                                <div class="flex items-center justify-between mb-2">
                                    <h3 class="text-sm font-semibold text-foreground">Temple Complex C</h3>
                                    <div class="flex items-center space-x-1">
                                        <div class="w-2 h-2 bg-success rounded-full"></div>
                                        <span class="text-xs font-medium text-success">Normal</span>
                                    </div>
                                </div>
                                <div class="text-xs text-muted-foreground space-y-1">
                                    <div>Est. People: <span class="font-semibold">125</span></div>
                                    <div>Density: <span class="font-semibold text-success">Low</span></div>
                                    <div>Behavior: <span class="font-semibold">Normal Flow</span></div>
                                </div>
                            </div>
                        </div>

                        <div class="border border-border rounded-lg overflow-hidden" data-mock="true">
                            <div class="relative">
                                <!-- Transit hub with people and vehicles -->
                                <img src="https://images.unsplash.com/photo-1571171637578-41bc2dd41cd2?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&h=200" alt="Camera feed from Transit Hub" class="w-full h-32 object-cover" data-mock-image="true" />
                                <div class="absolute top-2 left-2 bg-accent text-accent-foreground px-2 py-1 rounded text-xs font-bold">
                                    LIVE
                                </div>
                                <div class="absolute top-2 right-2 bg-card/90 backdrop-blur-sm text-foreground px-2 py-1 rounded text-xs">
                                    TH-B-12
                                </div>
                            </div>
                            <div class="p-3">
                                <div class="flex items-center justify-between mb-2">
                                    <h3 class="text-sm font-semibold text-foreground">Transit Hub B</h3>
                                    <div class="flex items-center space-x-1">
                                        <div class="w-2 h-2 bg-accent rounded-full"></div>
                                        <span class="text-xs font-medium text-accent">Moderate</span>
                                    </div>
                                </div>
                                <div class="text-xs text-muted-foreground space-y-1">
                                    <div>Est. People: <span class="font-semibold">340</span></div>
                                    <div>Density: <span class="font-semibold text-accent">Moderate</span></div>
                                    <div>Behavior: <span class="font-semibold">Queue Formation</span></div>
                                </div>
                            </div>
                        </div>
                        <!-- @END_MAP )) -->
                    </div>
                </div>
                <!-- @END_COMPONENT: CameraFeeds -->

                <!-- @COMPONENT: ControlPanel [alerts, volunteers, and system controls] -->
                <div class="bg-card rounded-lg border border-border overflow-hidden shadow-lg">
                    <div class="p-4 border-b border-border bg-muted/30">
                        <h2 class="text-lg font-semibold text-foreground">Control Center</h2>
                    </div>
                    <div class="p-4 space-y-6">
                        <!-- Alert System -->
                        <div>
                            <h3 class="text-sm font-semibold text-foreground mb-3">Broadcast Alerts</h3>
                            <div class="space-y-3">
                                <div class="grid grid-cols-3 gap-2">
                                    <button data-event="click:selectLanguage" class="bg-muted hover:bg-muted/80 text-muted-foreground border border-border px-3 py-2 rounded text-xs font-medium">
                                        हिंदी
                                    </button>
                                    <button data-event="click:selectLanguage" class="bg-primary text-primary-foreground px-3 py-2 rounded text-xs font-medium">
                                        English
                                    </button>
                                    <button data-event="click:selectLanguage" class="bg-muted hover:bg-muted/80 text-muted-foreground border border-border px-3 py-2 rounded text-xs font-medium">
                                        मराठी
                                    </button>
                                </div>
                                <textarea placeholder="Enter custom message or use AI-generated..." data-bind="alertMessage" class="w-full h-20 px-3 py-2 border border-input rounded-md bg-background text-sm resize-none"></textarea>
                                <div class="flex space-x-2">
                                    <button data-event="click:generateAlert" class="bg-accent hover:bg-accent/90 text-accent-foreground px-4 py-2 rounded text-sm font-medium flex-1">
                                        AI Generate
                                    </button>
                                    <button data-event="click:broadcastAlert" class="bg-primary hover:bg-primary/90 text-primary-foreground px-4 py-2 rounded text-sm font-medium flex-1">
                                        Broadcast
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Volunteer Management -->
                        <div>
                            <h3 class="text-sm font-semibold text-foreground mb-3">Active Volunteers</h3>
                            <div class="space-y-2">
                                <!-- @MAP: volunteers.map(volunteer => ( -->
                                <div class="flex items-center justify-between p-3 bg-muted/30 rounded-lg" data-mock="true">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-8 h-8 bg-success rounded-full flex items-center justify-center">
                                            <span class="text-xs font-semibold text-success-foreground">V1</span>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-foreground">Vol-247</p>
                                            <p class="text-xs text-muted-foreground">Ramghat Area</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="flex items-center space-x-1">
                                            <div class="w-2 h-2 bg-primary rounded-full"></div>
                                            <span class="text-xs text-primary font-medium">On Assignment</span>
                                        </div>
                                        <p class="text-xs text-muted-foreground">2 active tasks</p>
                                    </div>
                                </div>

                                <div class="flex items-center justify-between p-3 bg-muted/30 rounded-lg" data-mock="true">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-8 h-8 bg-success rounded-full flex items-center justify-center">
                                            <span class="text-xs font-semibold text-success-foreground">V2</span>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-foreground">Vol-156</p>
                                            <p class="text-xs text-muted-foreground">Temple Complex</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="flex items-center space-x-1">
                                            <div class="w-2 h-2 bg-success rounded-full"></div>
                                            <span class="text-xs text-success font-medium">Available</span>
                                        </div>
                                        <p class="text-xs text-muted-foreground">0 active tasks</p>
                                    </div>
                                </div>

                                <div class="flex items-center justify-between p-3 bg-muted/30 rounded-lg" data-mock="true">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-8 h-8 bg-muted rounded-full flex items-center justify-center">
                                            <span class="text-xs font-semibold text-muted-foreground">V3</span>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-foreground">Vol-089</p>
                                            <p class="text-xs text-muted-foreground">Transit Hub</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="flex items-center space-x-1">
                                            <div class="w-2 h-2 bg-muted-foreground rounded-full"></div>
                                            <span class="text-xs text-muted-foreground font-medium">Offline</span>
                                        </div>
                                        <p class="text-xs text-muted-foreground">Last seen: 13:45</p>
                                    </div>
                                </div>
                                <!-- @END_MAP )) -->
                            </div>
                        </div>

                        <!-- System Analytics -->
                        <div>
                            <h3 class="text-sm font-semibold text-foreground mb-3">Quick Analytics</h3>
                            <div class="grid grid-cols-2 gap-3">
                                <div class="text-center p-3 bg-muted/30 rounded-lg">
                                    <p class="text-lg font-bold text-foreground" data-bind="avgResponseTime">2.3m</p>
                                    <p class="text-xs text-muted-foreground">Avg Response</p>
                                </div>
                                <div class="text-center p-3 bg-muted/30 rounded-lg">
                                    <p class="text-lg font-bold text-foreground" data-bind="aiAccuracy">94%</p>
                                    <p class="text-xs text-muted-foreground">AI Accuracy</p>
                                </div>
                                <div class="text-center p-3 bg-muted/30 rounded-lg">
                                    <p class="text-lg font-bold text-foreground" data-bind="peakDensity">78%</p>
                                    <p class="text-xs text-muted-foreground">Peak Density</p>
                                </div>
                                <div class="text-center p-3 bg-muted/30 rounded-lg">
                                    <p class="text-lg font-bold text-foreground" data-bind="alertsSent">145</p>
                                    <p class="text-xs text-muted-foreground">Alerts Sent</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- @END_COMPONENT: ControlPanel -->

                <!-- @COMPONENT: AnalysisPanel [AI insights and lost person matching] -->
                <div class="bg-card rounded-lg border border-border overflow-hidden shadow-lg">
                    <div class="p-4 border-b border-border bg-muted/30">
                        <div class="flex items-center justify-between">
                            <h2 class="text-lg font-semibold text-foreground">AI Analysis & Lost Person Search</h2>
                            <button data-event="click:refreshAnalysis" class="text-muted-foreground hover:text-foreground">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="p-4 space-y-6 h-96 lg:h-[400px] overflow-y-auto">
                        <!-- Current Analysis -->
                        <div>
                            <h3 class="text-sm font-semibold text-foreground mb-3">Latest AI Analysis</h3>
                            <div class="bg-muted/30 rounded-lg p-4" data-mock="true">
                                <div class="flex items-center space-x-2 mb-3">
                                    <div class="w-3 h-3 bg-destructive rounded-full"></div>
                                    <span class="text-sm font-semibold text-destructive">High Risk Detected</span>
                                    <span class="text-xs text-muted-foreground">14:28:45</span>
                                </div>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span class="text-muted-foreground">Confidence:</span>
                                        <span class="font-semibold">87%</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-muted-foreground">Estimated People:</span>
                                        <span class="font-semibold">850+</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-muted-foreground">Behaviors:</span>
                                        <span class="font-semibold text-destructive">Panic Movement</span>
                                    </div>
                                </div>
                                <div class="mt-3 pt-3 border-t border-border">
                                    <p class="text-xs text-muted-foreground italic">"Sudden directional movement toward main exit with visible crowd compression and individuals showing distress signals"</p>
                                </div>
                            </div>
                        </div>

                        <!-- Lost Person Search -->
                        <div>
                            <h3 class="text-sm font-semibold text-foreground mb-3">Lost Person Search</h3>
                            <div class="space-y-3">
                                <div class="border-2 border-dashed border-border rounded-lg p-4 text-center">
                                    <svg class="w-8 h-8 text-muted-foreground mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                    </svg>
                                    <p class="text-xs text-muted-foreground">Upload photo to search database</p>
                                    <button data-event="click:uploadPhoto" data-implementation="Implement file upload for lost person search" class="mt-2 bg-primary hover:bg-primary/90 text-primary-foreground px-3 py-1 rounded text-xs">
                                        Upload Photo
                                    </button>
                                </div>
                                
                                <!-- Recent Search Results -->
                                <div class="space-y-2" data-mock="true">
                                    <h4 class="text-xs font-semibold text-muted-foreground">Recent Matches</h4>
                                    <div class="flex items-center space-x-3 p-2 bg-success/10 rounded border border-success/20">
                                        <div class="w-10 h-10 bg-muted rounded-full flex items-center justify-center">
                                            <span class="text-xs">👤</span>
                                        </div>
                                        <div class="flex-1">
                                            <p class="text-xs font-medium text-foreground">Match Found - 8yr old boy</p>
                                            <p class="text-xs text-muted-foreground">Confidence: 92% | Camera: TC-A-05</p>
                                        </div>
                                        <div class="text-right">
                                            <span class="text-xs bg-success text-success-foreground px-2 py-1 rounded">Verified</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div>
                            <h3 class="text-sm font-semibold text-foreground mb-3">Quick Actions</h3>
                            <div class="grid grid-cols-1 gap-2">
                                <button data-event="click:exportReports" class="bg-secondary hover:bg-secondary/90 text-secondary-foreground px-4 py-2 rounded text-sm font-medium">
                                    Export Today's Reports
                                </button>
                                <button data-event="click:viewAnalytics" class="bg-muted hover:bg-muted/80 text-muted-foreground border border-border px-4 py-2 rounded text-sm font-medium">
                                    View Analytics Dashboard
                                </button>
                                <button data-event="click:systemSettings" class="bg-muted hover:bg-muted/80 text-muted-foreground border border-border px-4 py-2 rounded text-sm font-medium">
                                    System Settings
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- @END_COMPONENT: ControlPanel -->
            </div>
        </div>
    </main>

    <!-- @COMPONENT: IncidentModal [detailed incident view and management] -->
    <div id="incidentModal" class="fixed inset-0 bg-foreground/50 backdrop-blur-sm hidden z-50" data-implementation="Modal for detailed incident management">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-card rounded-lg border border-border shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="p-6 border-b border-border">
                    <div class="flex items-center justify-between">
                        <h2 class="text-xl font-bold text-foreground">Incident Details</h2>
                        <button data-event="click:closeModal" class="text-muted-foreground hover:text-foreground">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="p-6 space-y-6" data-mock="true">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-sm font-medium text-muted-foreground">Incident ID</label>
                            <p class="text-sm font-mono text-foreground">INC-20280215-001</p>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-muted-foreground">Severity</label>
                            <p class="text-sm font-semibold text-destructive">Critical</p>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-muted-foreground">Location</label>
                            <p class="text-sm text-foreground">Ramghat-A, Sector 3</p>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-muted-foreground">Time</label>
                            <p class="text-sm text-foreground">14:28:45 IST</p>
                        </div>
                    </div>
                    
                    <div>
                        <label class="text-sm font-medium text-muted-foreground">Description</label>
                        <p class="text-sm text-foreground mt-1">AI detected sudden crowd surge with panic movement patterns. Estimated 850+ people moving rapidly toward main exit with visible blocking and compression.</p>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-sm font-medium text-muted-foreground">Assign to Volunteer</label>
                            <select data-bind="assignedVolunteer" class="w-full mt-1 px-3 py-2 border border-input rounded-md bg-background text-sm">
                                <option>Select volunteer...</option>
                                <option>Vol-247 (Ramghat Area)</option>
                                <option>Vol-156 (Temple Complex)</option>
                                <option>Vol-089 (Transit Hub)</option>
                            </select>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-muted-foreground">Priority Action</label>
                            <select data-bind="priorityAction" class="w-full mt-1 px-3 py-2 border border-input rounded-md bg-background text-sm">
                                <option>Crowd Control</option>
                                <option>Emergency Response</option>
                                <option>Medical Assistance</option>
                                <option>Evacuation Support</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button data-event="click:assignIncident" class="bg-primary hover:bg-primary/90 text-primary-foreground px-6 py-2 rounded-lg font-medium flex-1">
                            Assign & Notify
                        </button>
                        <button data-event="click:acknowledgeIncident" class="bg-secondary hover:bg-secondary/90 text-secondary-foreground px-6 py-2 rounded-lg font-medium flex-1">
                            Acknowledge
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- @END_COMPONENT: IncidentModal -->

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // TODO: Implement real-time WebSocket connections for live updates
        // TODO: Integrate with actual camera feeds and AI analysis pipeline
        // TODO: Implement actual volunteer assignment and notification system
        // TODO: Add multilingual support with proper translation service
        
        (function() {
            // Initialize Leaflet map
            const map = L.map('map').setView([23.1765, 75.7885], 13);
            
            // Add tile layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);
            
            // Mock heatmap data points
            const heatmapData = [
                { lat: 23.1765, lng: 75.7885, intensity: 0.9, name: 'Ramghat-A' },
                { lat: 23.1755, lng: 75.7895, intensity: 0.6, name: 'Triveni-B' },
                { lat: 23.1775, lng: 75.7875, intensity: 0.3, name: 'Temple-C' },
                { lat: 23.1785, lng: 75.7865, intensity: 0.7, name: 'Transit-D' }
            ];
            
            // Add heatmap markers
            heatmapData.forEach(point => {
                const color = point.intensity > 0.8 ? '#DC143C' : 
                             point.intensity > 0.5 ? '#FF6B35' : 
                             point.intensity > 0.3 ? '#FFD700' : '#228B22';
                
                L.circleMarker([point.lat, point.lng], {
                    color: color,
                    fillColor: color,
                    fillOpacity: 0.7,
                    radius: 15 + (point.intensity * 20),
                    weight: 2
                }).addTo(map).bindPopup(`
                    <div class="p-2">
                        <h3 class="font-semibold">${point.name}</h3>
                        <p class="text-sm">Density: ${(point.intensity * 100).toFixed(0)}%</p>
                        <p class="text-sm">Status: ${point.intensity > 0.8 ? 'Critical' : point.intensity > 0.5 ? 'High' : point.intensity > 0.3 ? 'Moderate' : 'Normal'}</p>
                    </div>
                `);
            });
            
            // Mock real-time updates
            setInterval(() => {
                // Simulate dynamic time updates
                const timeElement = document.querySelector('[data-bind="currentTime"]');
                if (timeElement) {
                    timeElement.textContent = new Date().toLocaleTimeString('en-IN', {
                        timeZone: 'Asia/Kolkata',
                        hour12: false
                    }) + ' IST';
                }
            }, 1000);

            // Modal functionality
            const modal = document.getElementById('incidentModal');
            
            // Show modal when clicking incident cards
            document.addEventListener('click', (e) => {
                if (e.target.closest('[data-event*="acknowledgeIncident"]') || 
                    e.target.closest('[data-event*="assignVolunteer"]')) {
                    modal.classList.remove('hidden');
                }
                
                if (e.target.closest('[data-event*="closeModal"]')) {
                    modal.classList.add('hidden');
                }
            });

            // Close modal when clicking outside
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.add('hidden');
                }
            });

            // Simulate real-time data updates
            setInterval(() => {
                // Update random metrics with small variations
                const elements = {
                    'totalPilgrims': () => (2847392 + Math.floor(Math.random() * 100 - 50)).toLocaleString(),
                    'activeIncidents': () => 23 + Math.floor(Math.random() * 5 - 2),
                    'avgResponseTime': () => (2.3 + (Math.random() * 0.4 - 0.2)).toFixed(1) + 'm',
                    'aiAccuracy': () => (94 + Math.floor(Math.random() * 4 - 2)) + '%',
                    'peakDensity': () => (78 + Math.floor(Math.random() * 10 - 5)) + '%',
                    'alertsSent': () => 145 + Math.floor(Math.random() * 10)
                };
                
                Object.entries(elements).forEach(([key, generator]) => {
                    const element = document.querySelector(`[data-bind="${key}"]`);
                    if (element && Math.random() < 0.1) { // 10% chance to update each cycle
                        element.textContent = generator();
                    }
                });
            }, 3000);

            // Emergency alert functionality
            document.addEventListener('click', (e) => {
                if (e.target.closest('[data-event*="triggerEmergencyAlert"]')) {
                    // Show confirmation dialog
                    if (confirm('Are you sure you want to trigger an emergency alert to all zones?')) {
                        // Simulate emergency alert broadcast
                        alert('Emergency alert broadcasted to all zones and mobile devices');
                        // TODO: Implement actual emergency alert system
                    }
                }
            });

            console.log('Drishti Command Center initialized');
        })();
    </script>
</body>
</html>